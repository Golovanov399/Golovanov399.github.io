
<div class="all_problems">
<div class="tooltip"><h3><a href="problem=264">Problem 586: Binary Quadratic Form<span class="tooltiptext">Published on Saturday, 14th January 2017, 10:00 pm<br>Solved by 194<br>Difficulty rating: 75%</span></a></h3></div>
<div class="problem_content">

<p>
The number 209 can be expressed as $a^2 + 3ab + b^2$ in two distinct ways:
</p>
<p>
$ \qquad 209 = 8^2 + 3\cdot 8\cdot 5 + 5^2$ <br>
$ \qquad 209 = 13^2 + 3\cdot13\cdot 1 + 1^2$
</br></p>
<p>
Let $f(n,r)$ be the number of integers $k$ not exceeding $n$ that can be expressed as $k=a^2 + 3ab + b^2$, with $a\gt b&gt;0$ integers, in exactly $r$ different ways.
</p>
<p>
You are given that $f(10^5, 4) = 237$ and $f(10^8, 6) = 59517$.
</p>
<p>
Find $f(10^{15}, 40)$.
</p>

</div>
</div>
<br>
<div style='page-break-after:always'></div>

